# Composite

## Introdu√ß√£o

Em sistemas de comunica√ß√£o online, a organiza√ß√£o hier√°rquica de conte√∫do representa um dos maiores desafios arquiteturais. O padr√£o Composite emerge como uma estrat√©gia estrutural que permite modelar e gerenciar eficientemente essas hierarquias complexas, tratando elementos at√¥micos e agregados atrav√©s de uma abordagem unificada.

A ess√™ncia do Composite reside na capacidade de abstrair as diferen√ßas entre componentes individuais e cole√ß√µes de componentes, permitindo que o c√≥digo cliente interaja com ambos atrav√©s de uma interface consistente. Esta uniformidade operacional elimina condicionais complexas e reduz significativamente o acoplamento entre m√≥dulos, caracter√≠sticas essenciais para sistemas escal√°veis e maint√≠veis.

Sistemas de f√≥runs de discuss√£o exemplificam perfeitamente cen√°rios onde o Composite demonstra seu valor. Nestes ambientes, coexistem elementos fundamentalmente distintos: mensagens individuais que representam contribui√ß√µes espec√≠ficas dos usu√°rios, e categorias tem√°ticas que organizam e agrupam essas contribui√ß√µes. A complexidade surge quando categorias podem conter n√£o apenas mensagens, mas tamb√©m subcategorias, formando uma rede hier√°rquica de profundidade vari√°vel.

Implementar funcionalidades como renderiza√ß√£o completa de discuss√µes, indexa√ß√£o de conte√∫do ou an√°lise de engajamento dos usu√°rios exigiria, tradicionalmente, algoritmos que distinguem entre diferentes tipos de elementos e navegam pela estrutura de forma espec√≠fica para cada tipo. Esta abordagem convencional gera c√≥digo fragmentado, com l√≥gica duplicada e alta depend√™ncia entre componentes.

## Metodologia

O desenvolvimento do modelo utilizando o padr√£o Composite iniciou-se com a an√°lise dos requisitos de um sistema de f√≥rum online. A necessidade de representar discuss√µes hier√°rquicas, onde t√≥picos podem conter postagens e sub-t√≥picos, evidenciou a adequa√ß√£o do padr√£o para resolver problemas de estruturas uniformes e aninhadas.

O padr√£o Composite demonstrou-se ideal para esta aplica√ß√£o por permitir tratamento uniforme de todos os elementos atrav√©s de uma interface comum, suportando aninhamento ilimitado e facilitando extensibilidade futura. Os requisitos do projeto alinharam-se diretamente com as vantagens oferecidas pelo padr√£o.

O modelo foi desenvolvido seguindo uma abordagem iterativa, come√ßando pela defini√ß√£o da interface abstrata `ForumComponent`. Esta interface incluiu o m√©todo essencial `exibir()` para apresenta√ß√£o de conte√∫do, al√©m de opera√ß√µes de composi√ß√£o como `add()`, `remove()` e `get_child()`. Embora estes m√©todos de composi√ß√£o n√£o sejam aplic√°veis a elementos folha, sua inclus√£o na interface mant√©m a uniformidade necess√°ria para o padr√£o.

Para demonstrar a aplica√ß√£o pr√°tica, foram implementados dois tipos fundamentais de componentes:

- **Elementos folha**, representados pela classe Postagem, que armazenam conte√∫do textual e atuam como n√≥s terminais da hierarquia.
- **Elementos compostos**, representados pela classe Topico, que gerenciam cole√ß√µes de outros componentes e implementam opera√ß√µes de manipula√ß√£o hier√°rquica.

Durante o processo de desenvolvimento, v√°rias quest√µes conceituais surgiram e foram resolvidas atrav√©s de an√°lise cuidadosa:

- **Sobre m√©todos de composi√ß√£o na interface**: Questionou-se inicialmente a necessidade de incluir m√©todos como `add()` e `remove()` na interface base, considerando que elementos folha n√£o os utilizariam. Compreendeu-se, contudo, que estes m√©todos s√£o fundamentais para manter a uniformidade da interface, objetivo central do padr√£o.

- **Sobre opera√ß√µes recursivas**: Discutiu-se a implementa√ß√£o de opera√ß√µes recursivas, como a exibi√ß√£o de conte√∫do em t√≥picos com m√∫ltiplos n√≠veis de aninhamento. A solu√ß√£o adotada permite navega√ß√£o natural pela estrutura atrav√©s dos m√©todos de composi√ß√£o.

Alternativas como separa√ß√£o de interfaces ou uso de heran√ßa m√∫ltipla foram consideradas, mas descartadas por comprometerem a simplicidade e uniformidade caracter√≠sticas do padr√£o. O modelo final seguiu rigorosamente os princ√≠pios cl√°ssicos do Composite, garantindo que elementos simples e compostos compartilhem a mesma interface.

## Modelagem

O uso do padr√£o Composite neste projeto cria uma estrutura onde uma √∫nica interface, chamada `ForumComponent`, define as regras que todos os elementos devem seguir ‚Äî tanto os itens individuais quanto os que agrupam outros elementos. Isso torna muito mais f√°cil trabalhar com a hierarquia, como mostrado na figura 1.

<center>
<p style="text-align: center"><b>Figura 1:</b> Primeira vers√£o do Diagrama de Classes do Padr√£o Composite</p>
<div align="center">
  <img src="assets/composite.png" alt="Diagrama UML do Composite Pattern" >
</div>
<font size="3"><p style="text-align: center"><b>Fonte:</b> <a href="https://github.com/DiegoCarlito">Diego Carlito</a> e <a href="https://github.com/Filipe-002">Filipe Carvalho</a>, 2025</p></font>
</center>

Os componentes principais da estrutura podem ser interpretados da seguinte forma:

- **ForumComponent**: Interface abstrata que define opera√ß√µes comuns para folhas e compostos, incluindo m√©todos de manipula√ß√£o hier√°rquica.
- **Postagem**: Implementa ForumComponent representando elementos terminais (folhas) da hierarquia, sem capacidade de conter outros elementos.
- **Topico**: Implementa ForumComponent com capacidade de gerenciar filhos, delegando opera√ß√µes recursivamente para seus componentes.

## C√≥digo

A implementa√ß√£o do padr√£o Composite em Python para o sistema de f√≥rum utiliza programa√ß√£o orientada a objetos e conceitos de abstra√ß√£o. As classes principais incluem a interface abstrata ForumComponent, as implementa√ß√µes concretas Postagem e Topico, al√©m de um exemplo de uso demonstrativo.

### Interface ForumComponent

```python
from abc import ABC, abstractmethod

class ForumComponent(ABC):
    """
    Interface abstrata que define opera√ß√µes comuns para 
    elementos simples e compostos do f√≥rum.
    """
    
    @abstractmethod
    def exibir(self):
        """M√©todo abstrato para exibi√ß√£o de conte√∫do."""
        pass

    def add(self, componente: 'ForumComponent'):
        """Adiciona um componente filho (usado apenas por compostos)."""
        raise NotImplementedError("Opera√ß√£o n√£o suportada para este tipo de elemento.")

    def remove(self, componente: 'ForumComponent'):
        """Remove um componente filho (usado apenas por compostos)."""
        raise NotImplementedError("Opera√ß√£o n√£o suportada para este tipo de elemento.")

    def get_child(self, index: int) -> 'ForumComponent':
        """Obt√©m um componente filho pelo √≠ndice (usado apenas por compostos)."""
        raise NotImplementedError("Opera√ß√£o n√£o suportada para este tipo de elemento.")
```

</center>
<font size="3"><p style="text-align: center"><b>Fonte:</b> <a href="https://github.com/DiegoCarlito">Diego Carlito</a>, 2025</p></font>
</center>

### Classe Postagem (Elemento Folha)

```python
class Postagem(ForumComponent):
    """
    Classe que representa uma postagem individual no f√≥rum.
    Atua como elemento folha na hierarquia Composite.
    """
    
    def __init__(self, autor: str, conteudo: str):
        self.autor = autor
        self.conteudo = conteudo

    def exibir(self):
        """Exibe o conte√∫do da postagem."""
        print(f"üìù Postagem de {self.autor}: {self.conteudo}")
```

</center>
<font size="3"><p style="text-align: center"><b>Fonte:</b> <a href="https://github.com/DiegoCarlito">Diego Carlito</a>, 2025</p></font>
</center>

### Classe Topico (Elemento Composto)

```python
class Topico(ForumComponent):
    """
    Classe que representa um t√≥pico de discuss√£o no f√≥rum.
    Atua como elemento composto, podendo conter postagens e sub-t√≥picos.
    """
    
    def __init__(self, titulo: str, descricao: str = ""):
        self.titulo = titulo
        self.descricao = descricao
        self.componentes = []

    def exibir(self, nivel: int = 0):
        """
        Exibe o t√≥pico e todos seus componentes recursivamente.
        O par√¢metro nivel permite indenta√ß√£o hier√°rquica.
        """
        indentacao = "  " * nivel
        print(f"{indentacao}üìÅ T√≥pico: {self.titulo}")
        
        if self.descricao:
            print(f"{indentacao}   Descri√ß√£o: {self.descricao}")
        
        for componente in self.componentes:
            if isinstance(componente, Topico):
                componente.exibir(nivel + 1)
            else:
                print("  " * (nivel + 1), end="")
                componente.exibir()

    def add(self, componente: ForumComponent):
        """Adiciona um componente (postagem ou sub-t√≥pico) ao t√≥pico."""
        self.componentes.append(componente)

    def remove(self, componente: ForumComponent):
        """Remove um componente do t√≥pico."""
        if componente in self.componentes:
            self.componentes.remove(componente)

    def get_child(self, index: int) -> ForumComponent:
        """Obt√©m um componente filho pelo √≠ndice especificado."""
        if 0 <= index < len(self.componentes):
            return self.componentes[index]
        raise IndexError("√çndice fora do intervalo v√°lido.")

    def get_total_postagens(self) -> int:
        """Calcula recursivamente o total de postagens no t√≥pico."""
        total = 0
        for componente in self.componentes:
            if isinstance(componente, Postagem):
                total += 1
            elif isinstance(componente, Topico):
                total += componente.get_total_postagens()
        return total
```

</center>
<font size="3"><p style="text-align: center"><b>Fonte:</b> <a href="https://github.com/DiegoCarlito">Diego Carlito</a>, 2025</p></font>
</center>

## Conclus√£o

A implementa√ß√£o do padr√£o estrutural Composite no sistema de f√≥rum demonstrou ser uma solu√ß√£o elegante e eficiente para gerenciar estruturas hier√°rquicas complexas. O diagrama de classes e a codifica√ß√£o em Python ilustraram como a interface `ForumComponent` e suas implementa√ß√µes (Postagem como elemento folha e Topico como elemento composto) proporcionam flexibilidade e uniformidade no tratamento de diferentes tipos de conte√∫do.

O padr√£o Composite ofereceu uma abstra√ß√£o poderosa que simplifica significativamente a manipula√ß√£o de elementos individuais e agrupamentos hier√°rquicos. A interface comum `ForumComponent` centralizou as opera√ß√µes essenciais, enquanto m√©todos espec√≠ficos de composi√ß√£o foram implementados apenas onde necess√°rio, mantendo a coes√£o do design.

A implementa√ß√£o demonstrou vantagens pr√°ticas importantes: opera√ß√µes recursivas como exibi√ß√£o de conte√∫do e c√°lculo de estat√≠sticas tornaram-se naturais e intuitivas; a adi√ß√£o de novos tipos de componentes pode ser realizada sem modificar c√≥digo existente; e a navega√ß√£o pela estrutura hier√°rquica √© transparente para o c√≥digo cliente.

Al√©m disso, o padr√£o estabeleceu uma base s√≥lida para expans√µes futuras do sistema, como implementa√ß√£o de funcionalidades de busca, modera√ß√£o de conte√∫do, ou sistemas de notifica√ß√£o que precisem percorrer toda a hierarquia de discuss√µes. A separa√ß√£o clara de responsabilidades entre componentes folha e compostos contribui diretamente para a manutenibilidade e escalabilidade da solu√ß√£o.

Por fim, a aplica√ß√£o do padr√£o Composite no contexto de um sistema de f√≥rum n√£o apenas resolveu os desafios imediatos de organiza√ß√£o hier√°rquica, mas tamb√©m estabeleceu uma arquitetura robusta e extens√≠vel para futuras necessidades do sistema.

## Bibliografia

> Refactoring Guru. Composite Design Pattern. Dispon√≠vel em: [https://refactoring.guru/design-patterns/composite](https://refactoring.guru/design-patterns/composite). Acessado em 01 de junho de 2025.

> Python Software Foundation. ABC ‚Äî Abstract Base Classes. Dispon√≠vel em: [https://docs.python.org/3/library/abc.html](https://docs.python.org/3/library/abc.html). Acessado em 01 de junho de 2025.

## Hist√≥rico de Vers√µes

| Vers√£o | Data       | Altera√ß√£o              | Respons√°vel     | Revisor           | Data de revis√£o |
|--------|------------|------------------------|------------------|-------------------|------------------|
| `1.0`  | 01/06/2025 | Cria√ß√£o do documento com introdu√ß√£o, metodologia e modelagem | [Diego Carlito](https://github.com/DiegoCarlito) e [Filipe Carvalho](https://github.com/Filipe-002) | [Gustavo Alves](https://github.com/gustaallves) | 02/06/2025  |
| `1.1`  | 01/06/2025 | Adi√ß√£o da implementa√ß√£o em Python | [Diego Carlito](https://github.com/DiegoCarlito) | [Gustavo Alves](https://github.com/gustaallves) | 02/06/2025  |
| `1.2`  | 01/06/2025 | Inclus√£o da conclus√£o e bibliografia | [Diego Carlito](https://github.com/DiegoCarlito) | [Gustavo Alves](https://github.com/gustaallves) | 02/06/2025 |
